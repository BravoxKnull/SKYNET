<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SKYNET - Next-Gen Voice Chat</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Audiowide&family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Ccircle cx='32' cy='32' r='30' fill='%23232a3a'/%3E%3Cellipse cx='32' cy='40' rx='18' ry='10' fill='%230db9d7'/%3E%3Crect x='18' y='22' width='28' height='14' rx='7' fill='%23a370f7'/%3E%3Ccircle cx='32' cy='29' r='4' fill='white'/%3E%3C/svg%3E">
    
    <!-- WebRTC and Socket.IO Scripts -->
    <script src="https://webrtc.github.io/adapter/adapter-latest.js"></script>
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <!-- Particle.js for background effects -->
    
    <!-- Fix for cursor-related errors -->
    <script>
        // Prevent cursor-related errors
        window.addEventListener('error', function(e) {
            if (e.message.includes('offsetX') || e.message.includes('cursor')) {
                e.preventDefault();
                console.warn('Cursor-related error prevented:', e.message);
            }
        });

        // Override problematic cursor functions
        if (window.applyCursorStyle) {
            window.applyCursorStyle = function() {
                return;
            };
        }
    </script>
</head>
<body>
    <!-- Auth Check Script -->
    <script>
        // Check if user is authenticated
        const user = JSON.parse(localStorage.getItem('user'))
        if (!user) {
            window.location.href = 'auth.html'
        }
    </script>

    <!-- Particle.js Background -->
    <div id="particles-js"></div>

    <!-- Cursor following background -->
    <div id="cursor-background"></div>

    <div class="app-container">
        <!-- Header -->
        <header class="header">
            <div class="logo-container">
                <div class="logo-wrapper">
                    <img src="assets/images/Skynet_Terminator_logo.svg" alt="SKYNET Logo" class="logo">
                    <div class="logo-glow"></div>
                </div>
                <h1>SKYNET</h1>
            </div>
            
            <div class="header-right">
                <div class="user-info">
                    <div class="avatar-wrapper">
                        <img id="navAvatar" src="assets/images/default-avatar.svg" alt="User Avatar" class="nav-avatar" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjNjY2IiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCI+PGNpcmNsZSBjeD0iMTIiIGN5PSI4IiByPSI1Ii8+PHBhdGggZD0iTTIwIDIxYTggOCAwIDAgMC0xNiAwIi8+PC9zdmc+'">
                        <div class="avatar-status"></div>
                    </div>
                    <span id="userDisplayName"></span>
                </div>
                <button class="hamburger-menu" id="hamburgerMenu">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
            </div>
            
            <nav class="nav-menu" id="navMenu">
                <div class="nav-links">
                    <a href="index.html" class="nav-link active">
                        <i class="fas fa-home"></i>
                        <span>Home</span>
                    </a>
                    <a href="devs.html" class="nav-link">
                        <i class="fas fa-code"></i>
                        <span>Devs</span>
                    </a>
                    <a href="about.html" class="nav-link">
                        <i class="fas fa-info-circle"></i>
                        <span>About</span>
                    </a>
                    <a href="profile.html" class="nav-link" target="_blank">
                        <i class="fas fa-user-cog" target="_blank"></i>
                        <span>Profile</span>
                    </a>
                    <button id="logoutBtn" class="nav-link">
                        <i class="fas fa-sign-out-alt"></i>
                        <span>Logout</span>
                    </button>
                </div>
            </nav>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- HERO Welcome Section (Redesigned) -->
            <section class="hero-welcome-section">
                <div class="hero-bg-animated" aria-hidden="true">
                    <!-- SVG/CANVAS Animated Background -->
                    <svg id="heroGridBG" width="100%" height="100%" viewBox="0 0 1440 600" preserveAspectRatio="none" style="position:absolute;top:0;left:0;width:100vw;height:100vh;z-index:0;">
                        <defs>
                            <linearGradient id="gridGradient" x1="0" y1="0" x2="1" y2="1">
                                <stop offset="0%" stop-color="#a370f7"/>
                                <stop offset="100%" stop-color="#0db9d7"/>
                            </linearGradient>
                        </defs>
                        <g id="gridLines"></g>
                    </svg>
                    <canvas id="heroParticles" style="position:absolute;top:0;left:0;width:100vw;height:100vh;z-index:1;pointer-events:none;"></canvas>
                </div>
                <div class="hero-glass-card">
                    <div class="hero-headline-container">
                        <h1 class="hero-headline animated-hero-headline">
                            <span class="hero-headline-text">Welcome to <span class="skynet-gradient">SKYNET</span></span>
                        </h1>
                        <div class="hero-subtitle">Experience the future of voice communication</div>
                    </div>
                    <div class="hero-carousel-container">
                        <button class="carousel-arrow left" id="heroCarouselPrev" aria-label="Previous Feature"><i class="fas fa-chevron-left"></i></button>
                        <div class="hero-carousel" id="heroFeatureCarousel">
                            <!-- Feature cards injected here -->
                        </div>
                        <button class="carousel-arrow right" id="heroCarouselNext" aria-label="Next Feature"><i class="fas fa-chevron-right"></i></button>
                    </div>
                    <div class="carousel-dots" id="heroCarouselDots"></div>
                </div>
            </section>

            <!-- Channel Section -->
            <section class="channel-section hidden" id="channelSection">
                <div class="channel-header">
                    <div class="channel-info">
                        <h2>DUNE PC</h2>
                        <span class="channel-type">Voice Channel</span>
                    </div>
                    <div class="channel-status">
                        <span class="status-indicator active" id="channelStatus">
                            <i class="fas fa-volume-up"></i>
                        </span>
                    </div>
                </div>
                
                <div class="users-grid" id="usersList">
                    <!-- Users will be added here dynamically -->
                </div>

                <div class="channel-controls">
                    <button id="muteBtn" class="control-btn">
                        <i class="fas fa-microphone"></i>
                        <span>Mute</span>
                    </button>
                    <button id="deafenBtn" class="control-btn">
                        <i class="fas fa-volume-mute"></i>
                        <span>Deafen</span>
                    </button>
                    <button id="screenshareBtn" class="control-btn">
                        <i class="fas fa-desktop"></i>
                        <span>Screen</span>
                    </button>
                    <button id="soundboardBtn" class="control-btn">
                        <i class="fas fa-music"></i>
                        <span>Soundboard</span>
                    </button>
                    <button id="leaveBtn" class="control-btn danger">
                        <i class="fas fa-sign-out-alt"></i>
                        <span>Leave</span>
                    </button>
                </div>
            </section>
        </main>

        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="join-section">
                <div class="input-group">
                    <label for="displayName">Display Name</label>
                    <div class="input-wrapper">
                        <input type="text" id="displayName" class="input-field" placeholder="Enter your display name" value="" readonly>
                        <i class="fas fa-user input-icon"></i>
                    </div>
                </div>
                <button id="joinBtn" class="join-btn">
                    <i class="fas fa-sign-in-alt"></i>
                    <span>Join DUNE PC</span>
                </button>
                <div id="warningMessage" class="warning-message"></div>
            </div>
            <div id="friendsSidebarList" class="friends-sidebar-list"></div>
        </aside>
        
        <!-- Chat Modal (hidden by default) -->
        <div id="chatModalOverlay" class="chat-modal-overlay" style="display:none;">
            <div id="chatModal" class="chat-modal">
                <button id="closeChatModal" class="close-chat-modal">&times;</button>
                <div class="chat-modal-content">
                    <div class="chat-modal-friends" id="chatModalFriends"></div>
                    <div class="chat-modal-main">
                        <div class="chat-modal-header" id="chatModalHeader"></div>
                        <div class="chat-modal-messages" id="chatModalMessages"></div>
                        <form class="chat-modal-input-form" id="chatModalInputForm">
                            <input type="text" class="chat-modal-input" id="chatModalInput" placeholder="Type a message..." autocomplete="off" />
                            <button type="submit" class="chat-modal-send-btn"><i class="fas fa-paper-plane"></i></button>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <!-- Soundboard Modal (hidden by default) -->
        <div id="soundboardModalOverlay" class="soundboard-modal-overlay" style="display:none;">
            <div id="soundboardModal" class="soundboard-modal">
                <button id="closeSoundboardModal" class="close-soundboard-modal">&times;</button>
                <div class="soundboard-header">
                    <span>Soundboard</span>
                    <label class="soundboard-toggle">
                        <input type="checkbox" id="soundboardToggle" checked>
                        <span>Enable</span>
                    </label>
                </div>
                <div class="soundboard-list" id="soundboardList"></div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="footer">
            <div class="footer-content">
                <div class="footer-grid">
                    <div class="footer-section">
                        <div class="footer-logo">
                            <img src="assets/images/Skynet_Terminator_logo.svg" alt="SKYNET Logo" class="footer-logo-img">
                            <h3>SKYNET</h3>
                        </div>
                        <p class="footer-description">
                            Experience the future of voice communication with SKYNET. Join our community of tech enthusiasts and gamers.
                        </p>
                        <div class="social-icons">
                            <a href="#" class="social-icon" title="Discord">
                                <i class="fab fa-discord"></i>
                            </a>
                            <a href="#" class="social-icon" title="Twitter">
                                <i class="fab fa-twitter"></i>
                            </a>
                            <a href="#" class="social-icon" title="GitHub">
                                <i class="fab fa-github"></i>
                            </a>
                            <a href="#" class="social-icon" title="YouTube">
                                <i class="fab fa-youtube"></i>
                            </a>
                        </div>
                    </div>

                    <div class="footer-section">
                        <h4>Quick Links</h4>
                        <ul class="footer-links">
                            <li><a href="index.html">Home</a></li>
                            <li><a href="devs.html">Developers</a></li>
                            <li><a href="about.html">About</a></li>
                            <li><a href="profile.html">Profile</a></li>
                        </ul>
                    </div>

                    <div class="footer-section">
                        <h4>Resources</h4>
                        <ul class="footer-links">
                            <li><a href="#">Documentation</a></li>
                            <li><a href="#">API Reference</a></li>
                            <li><a href="#">Community Guidelines</a></li>
                            <li><a href="#">Support</a></li>
                        </ul>
                    </div>

                    <div class="footer-section">
                        <h4>Legal</h4>
                        <ul class="footer-links">
                            <li><a href="legal/cookies.html" class="privacy-link" target="_blank">Cookie Policy</a></li>
                            <li><a href="legal/licenses.html" class="privacy-link" target="_blank">Licenses</a></li>
                            <li><a href="legal/privacy.html" class="privacy-link" target="_blank">Privacy Policy</a></li>
                            <li><a href="legal/terms.html" class="privacy-link" target="_blank">Terms of Service</a></li>
                            <li><a href="legal/licenses.html" class="privacy-link" target="_blank">Cookie Policy</a></li>
                        </ul>
                    </div>
                </div>

                <div class="footer-bottom">
                    <div class="footer-copyright">
                        <p>&copy; 2024 SKYNET. All rights reserved.</p>
                    </div>
                    <div class="footer-newsletter">
                        <form class="newsletter-form">
                            <input type="email" placeholder="Subscribe to our newsletter" required>
                            <button type="submit">
                                <i class="fas fa-paper-plane"></i>
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </footer>
    </div>

    <!-- Scripts -->
    <script>
        // Initialize Supabase client
        const supabaseUrl = 'https://jvjlvzidmcwcshbeielf.supabase.co'
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imp2amx2emlkbWN3Y3NoYmVpZWxmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDg2Nzg5ODksImV4cCI6MjA2NDI1NDk4OX0.pTuQXNNsnqLJhFbA6W47wNoTmLZq4Fw53xnUmZdEUUw'
        const supabase = window.supabase.createClient(supabaseUrl, supabaseKey)

        // Set the authenticated user's display name and avatar
        document.getElementById('userDisplayName').textContent = user.displayName
        document.getElementById('displayName').value = user.displayName

        // Add this near the top of your script
        console.log('Initializing avatar update listeners...');

        // Function to handle avatar updates
        function handleAvatarUpdate(avatarUrl, userId) {
            console.log('Processing avatar update for user:', userId, 'URL:', avatarUrl);
            
            // Update nav avatar
            const navAvatar = document.getElementById('navAvatar');
            if (navAvatar && userId === user?.id) {
                console.log('Updating nav avatar');
                // Create a new URL with timestamp to bust cache
                navAvatar.src = `${avatarUrl}?${Date.now()}`;
            }
            
            // Update user list avatars
            document.querySelectorAll('.user-avatar').forEach(avatar => {
                const avatarUserId = avatar.closest('[data-user-id]')?.dataset.userId;
                if (avatarUserId === userId) {
                    console.log('Updating user list avatar for:', userId);
                    // Create a new URL with timestamp to bust cache
                    avatar.src = `${avatarUrl}?${Date.now()}`;
                }
            });
        }

        // Method 1: Custom Event listener (for same-window updates)
        window.addEventListener('avatarUpdate', (event) => {
            console.log('Received custom event update:', event.detail);
            if (event.detail && event.detail.avatarUrl && event.detail.userId) {
                handleAvatarUpdate(event.detail.avatarUrl, event.detail.userId);
            }
        });

        // Method 2: BroadcastChannel listener (for cross-tab communication)
        if (window.BroadcastChannel) {
            const channel = new BroadcastChannel('avatar_updates');
            channel.onmessage = (event) => {
                if (event.data.type === 'avatarUpdate') {
                    console.log('Received BroadcastChannel update:', event.data);
                    handleAvatarUpdate(event.data.avatarUrl, event.data.userId);
                }
            };
        }

        // Method 3: localStorage event listener (fallback for cross-tab)
        window.addEventListener('storage', (event) => {
            if (event.key === 'avatarUpdate') {
                try {
                    const updateData = JSON.parse(event.newValue);
                    console.log('Received localStorage update:', updateData);
                    if (updateData && updateData.avatarUrl && updateData.userId) {
                        handleAvatarUpdate(updateData.avatarUrl, updateData.userId);
                    }
                } catch (error) {
                    console.error('Error processing avatar update:', error);
                }
            }
        });

        // Also listen for page visibility changes in case we missed updates
        document.addEventListener('visibilitychange', () => {
            if (document.visibilityState === 'visible') {
                console.log('Page became visible, checking for avatar updates');
                loadUserAvatar(); // Re-fetch the avatar when page becomes visible
            }
        });

        // Periodic avatar check (every 30 seconds)
        setInterval(() => {
            if (document.visibilityState === 'visible') {
                loadUserAvatar();
            }
        }, 30000);

        // Load user avatar
        async function loadUserAvatar() {
            try {
                const { data, error } = await supabase
                    .from('users')
                    .select('avatar_url')
                    .eq('id', user.id)
                    .single()

                if (error) throw error

                if (data && data.avatar_url) {
                    const navAvatar = document.getElementById('navAvatar');
                    if (navAvatar) {
                        // Add cache busting to the avatar URL
                        navAvatar.src = `${data.avatar_url}?${Date.now()}`;
                    }
                }
            } catch (error) {
                console.error('Error loading avatar:', error)
            }
        }

        // Load avatar when page loads
        loadUserAvatar()

        // Handle logout
        document.getElementById('logoutBtn').addEventListener('click', () => {
            localStorage.removeItem('user')
            window.location.href = 'auth.html'
        })

        // Add hamburger menu functionality
        const hamburgerMenu = document.getElementById('hamburgerMenu');
        const navMenu = document.getElementById('navMenu');

        hamburgerMenu.addEventListener('click', () => {
            hamburgerMenu.classList.toggle('active');
            navMenu.classList.toggle('active');
        });

        // Close menu when clicking outside
        document.addEventListener('click', (e) => {
            if (!hamburgerMenu.contains(e.target) && !navMenu.contains(e.target)) {
                hamburgerMenu.classList.remove('active');
                navMenu.classList.remove('active');
            }
        });

        // Close menu when window is resized
        window.addEventListener('resize', () => {
            if (window.innerWidth > 768) {
                hamburgerMenu.classList.remove('active');
                navMenu.classList.remove('active');
            }
        });

        // Listen for live display name updates from profile page
        if (window.BroadcastChannel) {
            const channel = new BroadcastChannel('profile_updates');
            channel.onmessage = (event) => {
                if (event.data.type === 'displayNameUpdate') {
                    document.getElementById('userDisplayName').textContent = event.data.displayName;
                    document.getElementById('displayName').value = event.data.displayName;
                    // Update localStorage
                    const user = JSON.parse(localStorage.getItem('user'));
                    if (user) {
                        user.displayName = event.data.displayName;
                        localStorage.setItem('user', JSON.stringify(user));
                    }
                }
            };
        }

        // Animated SVG Grid Background
        function animateHeroGrid() {
            const grid = document.getElementById('gridLines');
            if (!grid) return;
            grid.innerHTML = '';
            const cols = 24, rows = 10;
            for (let i = 0; i <= cols; i++) {
                const x = (i / cols) * 1440;
                const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                line.setAttribute('x1', x); line.setAttribute('y1', 0);
                line.setAttribute('x2', x); line.setAttribute('y2', 600);
                line.setAttribute('stroke', 'url(#gridGradient)');
                line.setAttribute('stroke-width', '1.2');
                line.setAttribute('opacity', '0.13');
                grid.appendChild(line);
            }
            for (let j = 0; j <= rows; j++) {
                const y = (j / rows) * 600;
                const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                line.setAttribute('x1', 0); line.setAttribute('y1', y);
                line.setAttribute('x2', 1440); line.setAttribute('y2', y);
                line.setAttribute('stroke', 'url(#gridGradient)');
                line.setAttribute('stroke-width', '1.2');
                line.setAttribute('opacity', '0.13');
                grid.appendChild(line);
            }
        }
        window.addEventListener('DOMContentLoaded', animateHeroGrid);
        window.addEventListener('resize', animateHeroGrid);
        // Animated Particles
        function animateHeroParticles() {
            const canvas = document.getElementById('heroParticles');
            if (!canvas) return;
            const ctx = canvas.getContext('2d');
            function resize() {
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
            }
            resize();
            window.addEventListener('resize', resize);
            const particles = Array.from({length: 36}, () => ({
                x: Math.random() * canvas.width,
                y: Math.random() * canvas.height,
                r: 1.5 + Math.random() * 2.5,
                dx: -0.5 + Math.random(),
                dy: -0.5 + Math.random(),
                color: Math.random() > 0.5 ? '#a370f7' : '#0db9d7',
                alpha: 0.5 + Math.random() * 0.5
            }));
            function draw() {
                ctx.clearRect(0,0,canvas.width,canvas.height);
                for (const p of particles) {
                    ctx.globalAlpha = p.alpha;
                    ctx.beginPath();
                    ctx.arc(p.x, p.y, p.r, 0, 2*Math.PI);
                    ctx.fillStyle = p.color;
                    ctx.shadowColor = p.color;
                    ctx.shadowBlur = 12;
                    ctx.fill();
                    ctx.shadowBlur = 0;
                    p.x += p.dx; p.y += p.dy;
                    if (p.x < 0) p.x = canvas.width; if (p.x > canvas.width) p.x = 0;
                    if (p.y < 0) p.y = canvas.height; if (p.y > canvas.height) p.y = 0;
                }
                ctx.globalAlpha = 1;
                requestAnimationFrame(draw);
            }
            draw();
        }
        window.addEventListener('DOMContentLoaded', animateHeroParticles);
        // Feature Carousel Data & Logic
        const heroFeatures = [
            {
                icon: 'fas fa-robot',
                title: 'AI-Powered',
                more: 'Harness advanced AI for automation and insight. Neural networks adapt to your needs.'
            },
            {
                icon: 'fas fa-chart-line',
                title: 'Real-Time Analytics',
                more: 'Monitor and analyze data as it happens for instant decision making.'
            },
            {
                icon: 'fas fa-cloud',
                title: 'Secure Cloud',
                more: 'Your data is protected with enterprise-grade security and encryption.'
            },
            {
                icon: 'fas fa-brain',
                title: 'Autonomous Agents',
                more: 'Deploy self-learning agents that adapt and optimize on their own.'
            },
            {
                icon: 'fas fa-clock',
                title: '24/7 Uptime',
                more: 'Always available, always reliable. SKYNET never sleeps.'
            },
            {
                icon: 'fas fa-graduation-cap',
                title: 'Adaptive Learning',
                more: 'Systems that evolve and improve with every interaction.'
            }
        ];
        let heroCurrent = 0;
        function renderHeroCarousel(idx) {
            const carousel = document.getElementById('heroFeatureCarousel');
            if (!carousel) return;
            carousel.innerHTML = '';
            // Previous
            const prevIdx = (idx - 1 + heroFeatures.length) % heroFeatures.length;
            const prev = document.createElement('div');
            prev.className = 'hero-carousel-card prev';
            prev.innerHTML = `<div class="feature-icon"><i class="${heroFeatures[prevIdx].icon}"></i></div><div class="feature-title">${heroFeatures[prevIdx].title}</div><div class="feature-more">${heroFeatures[prevIdx].more}</div>`;
            carousel.appendChild(prev);
            // Active
            const active = document.createElement('div');
            active.className = 'hero-carousel-card active';
            active.innerHTML = `<div class="feature-icon"><i class="${heroFeatures[idx].icon}"></i></div><div class="feature-title">${heroFeatures[idx].title}</div><div class="feature-more">${heroFeatures[idx].more}</div>`;
            carousel.appendChild(active);
            // Next
            const nextIdx = (idx + 1) % heroFeatures.length;
            const next = document.createElement('div');
            next.className = 'hero-carousel-card next';
            next.innerHTML = `<div class="feature-icon"><i class="${heroFeatures[nextIdx].icon}"></i></div><div class="feature-title">${heroFeatures[nextIdx].title}</div><div class="feature-more">${heroFeatures[nextIdx].more}</div>`;
            carousel.appendChild(next);
            // Dots
            const dots = document.getElementById('heroCarouselDots');
            if (dots) {
                dots.innerHTML = '';
                for (let i = 0; i < heroFeatures.length; i++) {
                    const dot = document.createElement('div');
                    dot.className = 'carousel-dot' + (i === idx ? ' active' : '');
                    dot.addEventListener('click', () => { heroCurrent = i; renderHeroCarousel(heroCurrent); });
                    dots.appendChild(dot);
                }
            }
        }
        function heroCarouselNext() {
            heroCurrent = (heroCurrent + 1) % heroFeatures.length;
            renderHeroCarousel(heroCurrent);
        }
        function heroCarouselPrev() {
            heroCurrent = (heroCurrent - 1 + heroFeatures.length) % heroFeatures.length;
            renderHeroCarousel(heroCurrent);
        }
        window.addEventListener('DOMContentLoaded', () => {
            renderHeroCarousel(heroCurrent);
            document.getElementById('heroCarouselNext').onclick = heroCarouselNext;
            document.getElementById('heroCarouselPrev').onclick = heroCarouselPrev;
            // Swipe support
            let startX = null;
            const carousel = document.getElementById('heroFeatureCarousel');
            if (carousel) {
                carousel.addEventListener('touchstart', e => { startX = e.touches[0].clientX; });
                carousel.addEventListener('touchend', e => {
                    if (startX === null) return;
                    const dx = e.changedTouches[0].clientX - startX;
                    if (dx > 40) heroCarouselPrev();
                    else if (dx < -40) heroCarouselNext();
                    startX = null;
                });
            }
            // Auto-advance
            setInterval(heroCarouselNext, 4200);
        });
    </script>
    <script src="main.js"></script>

    <!-- Audio elements for notifications -->
    <audio id="userJoinedSound" src="assets/sounds/user_joined.mp3" preload="auto"></audio>
    <audio id="userLeftSound" src="assets/sounds/user_left.mp3" preload="auto"></audio>

    <style>
        /* HERO Welcome Section Styles */
        .hero-welcome-section {
            position: relative;
            min-height: 80vh;
            width: 100vw;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            z-index: 1;
        }
        .hero-bg-animated {
            position: absolute;
            top: 0; left: 0; width: 100vw; height: 100vh;
            z-index: 0;
            pointer-events: none;
        }
        .hero-glass-card {
            position: relative;
            z-index: 2;
            background: var(--glass-bg, rgba(36,37,54,0.82));
            border-radius: 32px;
            box-shadow: 0 12px 48px 0 rgba(0,0,0,0.55);
            border: 2.5px solid var(--glass-border, rgba(163,112,247,0.25));
            backdrop-filter: blur(22px) saturate(1.2);
            padding: 3.5rem 2.5rem 2.5rem 2.5rem;
            max-width: 600px;
            width: 98vw;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 2.5rem;
            margin-top: 2.5rem;
            animation: fadeInScale 1.2s cubic-bezier(.4,2,.6,1);
        }
        .hero-headline-container {
            text-align: center;
        }
        .hero-headline {
            font-family: 'Audiowide', 'Orbitron', sans-serif;
            font-size: 3.2rem;
            font-weight: 700;
            letter-spacing: 2.5px;
            margin-bottom: 0.7rem;
            color: transparent;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            background-clip: text;
            text-shadow: 0 0 32px #a370f7cc, 0 0 8px #0db9d7cc;
            position: relative;
            overflow: visible;
        }
        .skynet-gradient {
            background: linear-gradient(90deg, #a370f7 0%, #0db9d7 100%);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            filter: drop-shadow(0 2px 12px #a370f7aa);
        }
        .animated-hero-headline .hero-headline-text {
            display: inline-block;
            animation: heroShimmer 3.5s infinite linear, heroPulse 2.5s infinite alternate;
        }
        @keyframes heroShimmer {
            0% { filter: brightness(1) drop-shadow(0 0 0 #fff0); }
            40% { filter: brightness(1.2) drop-shadow(0 0 16px #a370f7cc); }
            60% { filter: brightness(1.4) drop-shadow(0 0 32px #0db9d7cc); }
            100% { filter: brightness(1) drop-shadow(0 0 0 #fff0); }
        }
        @keyframes heroPulse {
            0% { letter-spacing: 2.5px; }
            100% { letter-spacing: 6px; }
        }
        .hero-subtitle {
            font-family: 'Roboto', sans-serif;
            font-size: 1.25rem;
            color: var(--accent-color);
            opacity: 0.92;
            margin-bottom: 0.2rem;
            letter-spacing: 0.5px;
        }
        .hero-carousel-container {
            display: flex;
            align-items: center;
            gap: 1.2rem;
            width: 100%;
            justify-content: center;
        }
        .hero-carousel {
            display: flex;
            align-items: stretch;
            justify-content: center;
            min-width: 320px;
            max-width: 420px;
            width: 100%;
            height: 220px;
            position: relative;
            perspective: 1200px;
            overflow: visible;
        }
        .hero-carousel-card {
            background: var(--card-bg, rgba(36,37,54,0.92));
            border-radius: 22px;
            box-shadow: 0 8px 32px 0 rgba(0,0,0,0.45);
            border: 2px solid var(--border-color, rgba(163,112,247,0.2));
            padding: 2.2rem 2rem 2rem 2rem;
            color: var(--text-color, #e0e0e0);
            font-family: 'Roboto', 'Orbitron', sans-serif;
            font-size: 1.18rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-width: 340px;
            max-width: 420px;
            width: 100%;
            opacity: 0;
            transform: translateX(60px) scale(0.98) rotateY(40deg);
            transition: opacity 0.7s cubic-bezier(.4,2,.6,1), transform 0.7s cubic-bezier(.4,2,.6,1);
            pointer-events: none;
            position: absolute;
            left: 0; right: 0; top: 0; bottom: 0;
            margin: auto;
        }
        .hero-carousel-card.active {
            opacity: 1;
            transform: translateX(0) scale(1.04) rotateY(0deg);
            pointer-events: auto;
            z-index: 2;
        }
        .hero-carousel-card.prev {
            opacity: 0.5;
            transform: translateX(-120px) scale(0.95) rotateY(-30deg);
            z-index: 1;
        }
        .hero-carousel-card.next {
            opacity: 0.5;
            transform: translateX(120px) scale(0.95) rotateY(30deg);
            z-index: 1;
        }
        .hero-carousel-card .feature-icon {
            font-size: 2.5rem;
            color: var(--primary-color, #a370f7);
            margin-bottom: 1.1rem;
            filter: drop-shadow(0 2px 12px #a370f7aa);
            animation: floatIcon 2.5s infinite ease-in-out;
        }
        @keyframes floatIcon {
            0% { transform: translateY(0); }
            50% { transform: translateY(-10px) scale(1.08); }
            100% { transform: translateY(0); }
        }
        .hero-carousel-card .feature-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--primary-color, #a370f7);
            margin-bottom: 0.6rem;
            letter-spacing: 1.5px;
            font-family: 'Audiowide', 'Orbitron', sans-serif;
        }
        .hero-carousel-card .feature-more {
            font-size: 1.01rem;
            color: var(--accent-color, #0db9d7);
            opacity: 0.85;
            margin-top: 0.2rem;
            text-align: center;
        }
        .carousel-arrow {
            background: rgba(163,112,247,0.12);
            border: none;
            border-radius: 50%;
            width: 44px; height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary-color);
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 2px 12px #a370f7aa;
            transition: background 0.2s, transform 0.2s;
            z-index: 3;
        }
        .carousel-arrow:hover {
            background: rgba(163,112,247,0.25);
            transform: scale(1.12);
        }
        .carousel-dots {
            display: flex;
            justify-content: center;
            gap: 0.5rem;
            margin-top: 1.2rem;
        }
        .carousel-dot {
            width: 12px; height: 12px;
            border-radius: 50%;
            background: var(--border-color, #a370f7);
            opacity: 0.5;
            transition: background 0.3s, opacity 0.3s;
            cursor: pointer;
        }
        .carousel-dot.active {
            background: var(--primary-color, #a370f7);
            opacity: 1;
            box-shadow: 0 0 8px #a370f7cc;
        }
        @media (max-width: 700px) {
            .hero-glass-card { padding: 2rem 0.5rem 1.5rem 0.5rem; max-width: 99vw; }
            .hero-headline { font-size: 2.1rem; }
            .hero-carousel-card, .hero-carousel { min-width: 98vw; max-width: 100vw; font-size: 0.98rem; }
            .hero-carousel { height: 180px; }
        }
        @media (max-width: 480px) {
            .hero-glass-card { padding: 1.2rem 0.2rem 1rem 0.2rem; }
            .hero-headline { font-size: 1.3rem; }
            .hero-carousel { height: 140px; }
        }
    </style>
</body>
</html> 